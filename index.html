<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lua ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆãƒ„ãƒ¼ãƒ«</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
        }
        h1 {
            text-align: center;
        }
        label {
            display: block;
            margin: 10px 0 5px;
        }
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background-color: #28a745;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background-color: #218838;
        }
        pre {
            background-color: #f8f9fa;
            padding: 15px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>

    <h1>ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆãƒ„ãƒ¼ãƒ«</h1>
    <h1>è£½ä½œè€…ğŸ„ãã®ã“ğŸ„</h1>
    <p><a href="https://discord.gg/eaUt5a7k4P" target="_blank">Discord!</a></p>
    
    <form id="scriptForm">
        <label for="menu_count">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®å€‹æ•°:</label>
        <input type="number" id="menu_count" name="menu_count" min="1" onchange="generateMenuForms()" required>

        <div id="menuForms"></div>

        <button type="button" onclick="generateScript()">ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”Ÿæˆ</button>
    </form>

    <h2>ç”Ÿæˆã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆ:</h2>
    <pre id="generatedScript"></pre>
    <button id="downloadButton" style="display:none;" onclick="downloadScript()">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
    <h5>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ããªã„å ´åˆã¯ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã„ã¦ãã ã•ã„</h5>
    
    <script>
        function generateMenuForms() {
            const menuCount = document.getElementById('menu_count').value;
            const menuFormsContainer = document.getElementById('menuForms');
            menuFormsContainer.innerHTML = ''; // æ—¢å­˜ã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’ã‚¯ãƒªã‚¢

            for (let i = 1; i <= menuCount; i++) {
                const menuDiv = document.createElement('div');
                menuDiv.innerHTML = `
                    <label for="menuName${i}">ãƒ¡ãƒ‹ãƒ¥ãƒ¼å${i}:</label>
                    <input type="text" id="menuName${i}" placeholder="ãƒ¡ãƒ‹ãƒ¥ãƒ¼åã‚’å…¥åŠ›" required>
                    
                    <label for="cheatCount${i}">ãƒãƒ¼ãƒˆã®å€‹æ•°:</label>
                    <input type="number" id="cheatCount${i}" name="cheatCount${i}" min="1" value="1" onchange="generateCheatForms(${i})" required>

                    <div id="cheatForms${i}"></div>
                `;
                menuFormsContainer.appendChild(menuDiv);
            }
            generateCheatForms(1); // åˆå›ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’ç”Ÿæˆ
        }

        function generateCheatForms(menuIndex) {
            const cheatCount = document.getElementById(`cheatCount${menuIndex}`).value;
            const container = document.getElementById(`cheatForms${menuIndex}`);
            container.innerHTML = ''; // æ—¢å­˜ã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’ã‚¯ãƒªã‚¢

            for (let j = 1; j <= cheatCount; j++) {
                const cheatDiv = document.createElement('div');
                cheatDiv.className = 'cheat-form';
                cheatDiv.innerHTML = `
                    <label for="cheatName${menuIndex}_${j}">ãƒãƒ¼ãƒˆ${j}ã®åå‰:</label>
                    <input type="text" id="cheatName${menuIndex}_${j}" placeholder="ãƒãƒ¼ãƒˆåã‚’å…¥åŠ›" required>
                `;
                container.appendChild(cheatDiv);
            }
        }

        function generateScript() {
            const menuCount = document.getElementById('menu_count').value;

    for (let i = 1; i <= menuCount; i++) {
        const menuName = document.getElementById(`menuName${i}`).value;
        if (!menuName.trim()) {
            alert(`ãƒ¡ãƒ‹ãƒ¥ãƒ¼å${i}ãŒæœªå…¥åŠ›ã§ã™ã€‚`);
            return;
        }
        
        const cheatCount = document.getElementById(`cheatCount${i}`).value;
        for (let j = 1; j <= cheatCount; j++) {
            const cheatName = document.getElementById(`cheatName${i}_${j}`).value;
            if (!cheatName.trim()) {
                alert(`ãƒãƒ¼ãƒˆ${j}ã®åå‰ãŒæœªå…¥åŠ›ã§ã™ã€‚`);
                return;
            }
        }
    }
            let lua_script = `
gg.clearResults()
gg.alert("made by kinoko", 'start')

function Main()
    local menu = gg.choice({
            `;
            const menuData = [];
            for (let i = 1; i <= menuCount; i++) {
                const menuName = document.getElementById(`menuName${i}`).value;
                const cheatCount = document.getElementById(`cheatCount${i}`).value;
                let submenuItems = [];

                for (let j = 1; j <= cheatCount; j++) {
                    const cheatName = document.getElementById(`cheatName${i}_${j}`).value;
                    let onCode = prompt(`${cheatName} ã®ONã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:`);
                    let offCode = prompt(`${cheatName} ã®OFFã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:`);

                    // ä½™åˆ†ãªç©ºç™½ã‚’å‰Šé™¤ã—ã€æ”¹è¡Œ
                    onCode = formatCode(onCode);
                    offCode = formatCode(offCode);

                    submenuItems.push({ name: cheatName, onCode: onCode, offCode: offCode });
                }
		
                menuData.push({ name: menuName, submenuItems: submenuItems });
                lua_script += `        "${menuName}",\n`;
            }

            lua_script += '        "çµ‚äº†",\n';
            lua_script += '    }, nil, "Easy-Script")\n\n';

            lua_script += '    if menu == nil then\n';
            lua_script += '        return\n';
            lua_script += '    end\n';
	    
            for (let i = 1; i <= menuCount; i++) {
                lua_script += `    if menu == ${i} then AAA${i}() end\n`;
            }
		
	    
            lua_script += `    if menu == ${Number(menuCount) + 1} then exit() end\n`;
            lua_script += 'end\n\n';

            for (let i = 1; i <= menuCount; i++) {
                lua_script += `toggle_${String(i).padStart(3, '0')}_001 = false\n`;
            }

            for (let i = 1; i <= menuCount; i++) {
                lua_script += `\nfunction AAA${i}()\n`;

                const submenuItems = menuData[i - 1].submenuItems;
                for (let j = 0; j < submenuItems.length; j++) {
                    const cheatName = submenuItems[j].name;
                    lua_script += `    local state_${String(i).padStart(3, '0')}_${String(j + 1).padStart(3, '0')} = toggle_${String(i).padStart(3, '0')}_${String(j + 1).padStart(3, '0')} and "${cheatName} OFF" or "${cheatName} ON"\n`;
                }

                lua_script += `    local A${i} = gg.multiChoice({\n`;
                for (let j = 0; j < submenuItems.length; j++) {
                    lua_script += `        state_${String(i).padStart(3, '0')}_${String(j + 1).padStart(3, '0')},\n`;
                }
                lua_script += '        "æˆ»ã‚‹",\n';
                lua_script += '    }, nil, "Easy-Script")\n\n';

                lua_script += `    if A${i} == nil then return end\n`;
                for (let j = 0; j < submenuItems.length; j++) {
                    lua_script += `    if A${i}[${j + 1}] == true then B${String(i).padStart(3, '0')}_${String(j + 1).padStart(3, '0')}() end\n`;
                }

                lua_script += `    if A${i}[${submenuItems.length + 1}] == true then Main() end\n`;
                lua_script += 'end\n';
            }

            for (let i = 1; i <= menuCount; i++) {
                const submenuItems = menuData[i - 1].submenuItems;
                for (let j = 0; j < submenuItems.length; j++) {
                    const onCode = submenuItems[j].onCode;
                    const offCode = submenuItems[j].offCode;
                    lua_script += `\nfunction B${String(i).padStart(3, '0')}_${String(j + 1).padStart(3, '0')}()\n`;
                    lua_script += `    if toggle_${String(i).padStart(3, '0')}_${String(j + 1).padStart(3, '0')} then\n`;
                    lua_script += `        gg.clearResults()\n${offCode}\n`;
                    lua_script += '    else\n';
                    lua_script += `        gg.clearResults()\n${onCode}\n`;
                    lua_script += '    end\n';
       		    lua_script += `    toggle_${String(i).padStart(3, '0')}_${String(j + 1).padStart(3, '0')} = not toggle_${String(i).padStart(3, '0')}_${String(j + 1).padStart(3, '0')}\n`;
                    lua_script += 'end\n';
                }
            }

            lua_script += '\nfunction exit()\n    gg.toast("Easy Script by t0x1c")\n    gg.clearResults()\n    os.exit()\nend\n';
            lua_script += 'while true do\n    if gg.isVisible() then\n        gg.setVisible(false)\n        Main()\n    end\n    gg.sleep(10) \nend\n';

            document.getElementById('generatedScript').textContent = lua_script;
            document.getElementById('downloadButton').style.display = 'block';
        }

        function formatCode(code) {
            if (!code) return '';

            return code
  	     .replace(/\s+/g, ' ') 
   	     .trim() 
	     .replace(/\)\s*/g, ')\n') 
        }

        function downloadScript() {
            const scriptContent = document.getElementById('Easy-Scripts').textContent;
            const blob = new Blob([scriptContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'generated_script.lua';
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>

</body>
</html>
